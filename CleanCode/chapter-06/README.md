### 对象和数据结构
#### 数据抽象
下面两段代码。每段代码都表示笛卡尔平面上的一个点。
```java
// 代码清单6-1 具象点
public class Point{
    public double x;
    public double y;
}
```
```java
// 代码清单6-2 抽象点
public interface Point{
   double getX();
   double getY();
   void setCartesian(double x, double y);
   double getR();
   double getTheta();
   void setPolar(double r, double theta);
}
```
代码清单6-2的漂亮之处在于，你不知道该实现会是在矩形坐标系中还是在极坐标系中。可能两个都不是！然而，该接口还是明白无误地呈现一种数据结构。

我们不愿暴露数据细节，更愿意以抽象形态表述数据。这并不只是用接口和/或赋值器、取值器就万事大吉。要以最好的方式呈现某个对象包含的数据，需要做严肃的思考。乱加取值器和赋值器，是最坏的选择。

#### 数据、对象的反对称性
这两个例子展示了对象与数据结构之间的差异。

对象把数据隐藏于抽象之后，暴露操作数据的函数。数据结构暴露其数据，没有提供有意义的函数。它们是对立的。
（示例见P89、P90）
这说明了对象与数据结构之间的二分原理：

>过程式代码（使用数据结构的代码）便于在不改动既有数据结构的前提下添加新函数。面向对象代码便于在不改动既有函数的前提下添加新累。

反过来讲也说得通：
>过程式代码难以添加新数据结构，因为必须修改所有函数。面向对象难以添加新函数，因为必须修改所有类。

在任何一个复杂系统中，都会有需要添加新数据类型而不是新函数的时候。这时，对象和面向对象就比较合适。
另一方面，也会有想要添加新函数而不是数据类型的时候。在这种情况下，过程式代码和数据结构更合适。

#### 得墨忒耳律
得墨忒耳律认为，模块不应了解它所操作对象的内部情形。如上节所见，对象隐藏数据，暴露操作。这意味着对象不应通过存取器暴露其内部结构，因为这样更像是暴露而非隐藏其内部结构。

更准确地说，得墨忒耳律认为，类C的方法f只应该调用以下对象的方法：
- C
- 由f创建的对象
- 作为参数传递给f的对象
- 由C的实体变量持有的对象

方法不应调用由任何函数返回的对象的方法。

下列代码违反了得墨忒耳律，因为它调用了getOptions()返回值得getScratchDir()函数，又调用了getScratchDir()返回值得getAbsolutePath()方法。

```java
final String outputDir = ctxt.getOptions().getScratchDir().getAbsolutePath();
```

##### 1.火车失事
上述代码常被称作`火车失事`，因为它看起来就像是一列火车。这类连串的调用通常被认为是肮脏的风格，应该避免。最好做类似如下的切分：
```java
Options opts = ctxt.getOptions();
File scratchDir = opts.getScratchDir();
final String outputDir = scratchDir.getAbsolutePath(); 
```
上列代码是否违反了得墨忒耳律？当然，模块知道ctxt对象包含有多个选项，每个选项中有一个临时目录， 而每个临时目录都有一个绝对路径。对于一个函数，这些知识真够丰富的。调用函数懂得如何在一大堆不同对象间浏览。

这些代码是否违反得墨忒耳律取决于ctxt、Options和ScratchDir是对象还是数据结构。

属性访问器函数的使用把问题搞复杂了。如果像下边代码这样写，大概就不会提及违反了得墨忒耳律。
```java
final String outputDir = ctxt.options.scratchDir.absolutePath;
```

如果数据结构只简单地拥有公共变量，没有函数，而对象拥有私有变量和公共函数，这个问题就不那么混淆了。然而，有些框架和标准甚至要求最简单的数据结构都要有访问器和改值器。

##### 2.混杂
（见P92）

##### 3.隐藏结构
##### 4.数据传送对象(DTO)
最为精炼的数据结构，是一个只有公共变量、没有函数的类。
(见P93、P94)

##### 5.小结
对象暴露行为，隐藏数据。便于添加新对象类型而无需修改既有行为，同时也难以在既有对象中添加行为。
数据结构暴露数据，没有明显的行为。便于向既有数据结构添加新行为，同时也难以向既有函数添加新数据结构。

优秀的软件开发者不带成见地了解这种情形并依据手边工作的性质选择其中一种手段。